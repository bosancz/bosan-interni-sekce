<ion-card *ngIf="event" class="event">
  <ion-card-header>
    <!-- TODO: align icon for md and ios-->
    <div
      class="icon mx-auto"
      [style.background-color]="(event | event: 'image') ? 'transparent' : (event | event: 'color') || '#ccc'"
    >
      <img *ngIf="event | event: 'image'" class="img-fluid" [src]="event | event: 'image'" />
    </div>

    <ion-card-title>{{ event?.name }}</ion-card-title>

    <ion-card-subtitle *ngIf="event?.dateFrom || event?.place">
      <ng-container *ngIf="event?.dateFrom">{{ [event.dateFrom, event.dateTill] | dateRange }}</ng-container>
      <ng-container *ngIf="event?.dateFrom && event?.place">, </ng-container>
      <ng-container *ngIf="event?.place">{{ event.place }}</ng-container>
    </ion-card-subtitle>
  </ion-card-header>

  <ion-card-content>
    <p *ngIf="event?.description" class="description">{{ event.description }}</p>

    <p *ngIf="event.meeting?.start || event.meeting?.end">
      <ng-container *ngIf="event.meeting?.start"><strong>Sraz: </strong>{{ event.meeting?.start }}</ng-container>
      <ng-container *ngIf="event.meeting?.start && event.meeting?.end">, </ng-container>
      <ng-container *ngIf="event.meeting?.end"><strong>Konec: </strong>{{ event.meeting?.end }}</ng-container>
    </p>
    <p>Vede <strong [innerHTML]="event.leaders?.length ? (event.leaders! | joinLeaders) : 'pan NIKDO'"></strong></p>
  </ion-card-content>

  <ion-buttons *ngIf="actions && event?._actions" slot="end">
    <ion-button
      *ngIf="event._actions?.submit"
      class="mx-0"
      [disabled]="!event._actions?.submit?.allowed"
      (click)="eventAction(event._actions?.submit!)"
    >
      Ke schválení
    </ion-button>

    <ion-button
      *ngIf="event._actions?.reject"
      class="mx-0"
      [disabled]="!event._actions!.reject.allowed"
      (click)="eventAction(event._actions?.reject!, true)"
    >
      K úpravám
    </ion-button>

    <ion-button
      *ngIf="event._actions?.publish"
      class="mx-0"
      [disabled]="!event._actions!.publish.allowed"
      (click)="eventAction(event._actions?.publish!)"
    >
      Do programu
    </ion-button>

    <ion-button
      *ngIf="event._actions?.unpublish"
      class="mx-0"
      [disabled]="!event._actions!.unpublish.allowed"
      (click)="eventAction(event._actions?.unpublish!)"
    >
      Z programu
    </ion-button>

    <ion-button
      *ngIf="event._actions?.cancel"
      class="mx-0"
      [disabled]="!event._actions!.cancel.allowed"
      (click)="eventAction(event._actions?.cancel!)"
    >
      Zrušit akci
    </ion-button>

    <ion-button
      *ngIf="event._actions?.uncancel"
      class="mx-0"
      [disabled]="!event._actions!.uncancel.allowed"
      (click)="eventAction(event._actions?.uncancel!)"
    >
      Vrátit zrušení
    </ion-button>

    <ion-button color="secondary" class="mx-0" [routerLink]="'/akce/' + event._id">Otevřít</ion-button>
  </ion-buttons>
</ion-card>
