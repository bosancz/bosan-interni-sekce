<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
    <ion-title pageTitle>Schvalování akcí</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="dashboard">
    <ion-item class="d-lg-none mb-3">
      <ion-select [(ngModel)]="selectedColumn">
        <ion-select-option value="noLeader">Pan NIKDO ({{ (noLeaderEvents | async)?.length || 0 }})</ion-select-option>
        <ion-select-option value="draft">V přípravě ({{ (draftEvents | async)?.length || 0 }})</ion-select-option>
        <ion-select-option value="pending">Ke schválení ({{ (pendingEvents | async)?.length || 0 }})</ion-select-option>
        <ion-select-option value="public">V programu ({{ (publicEvents | async)?.length || 0 }})</ion-select-option>
      </ion-select>
    </ion-item>

    <ng-template #eventsColumn let-events>
      <event-card
        *ngFor="let event of events"
        [event]="event"
        (change)="eventChanged($event)"
        class="mb-3"
      ></event-card>
      <p *ngIf="!loading && events?.length === 0" class="text-center noevents">Žádné akce</p>
    </ng-template>

    <div class="row">
      <div class="col-12 col-lg-3 d-lg-block" [class.d-none]="selectedColumn !== 'noLeader'">
        <ion-item lines="none" class="d-none d-lg-block">
          <ion-label><h2>Pan NIKDO</h2></ion-label>
          <ion-badge color="light">{{ (noLeaderEvents | async)?.length }}</ion-badge>
        </ion-item>
        <div class="column bg-light px-2 py-2 mb-3">
          <ng-container *ngTemplateOutlet="eventsColumn; context: { $implicit: noLeaderEvents | async }"></ng-container>
        </div>
      </div>

      <div class="col-12 col-lg-3 d-lg-block" [class.d-none]="selectedColumn !== 'draft'">
        <ion-item lines="none" class="d-none d-lg-block">
          <ion-label><h2>V přípravě</h2></ion-label>
          <ion-badge color="light">{{ (draftEvents | async)?.length }}</ion-badge>
        </ion-item>
        <div class="column bg-light px-2 py-2 mb-3">
          <ng-container *ngTemplateOutlet="eventsColumn; context: { $implicit: draftEvents | async }"></ng-container>
        </div>
      </div>

      <div class="col-12 col-lg-3 d-lg-block" [class.d-none]="selectedColumn !== 'pending'">
        <ion-item lines="none" class="d-none d-lg-block">
          <ion-label><h2>Ke schválení</h2></ion-label>
          <ion-badge color="light">{{ (pendingEvents | async)?.length }}</ion-badge>
        </ion-item>
        <div
          class="column bg-light px-2 py-2 mb-3"
          [class.bg-light]="!(pendingEvents | async)?.length"
          [class.bg-primary]="(pendingEvents | async)?.length"
        >
          <ng-container *ngTemplateOutlet="eventsColumn; context: { $implicit: pendingEvents | async }"></ng-container>
        </div>
      </div>

      <div class="col-12 col-lg-3 d-lg-block" [class.d-none]="selectedColumn !== 'public'">
        <ion-item lines="none" class="d-none d-lg-block">
          <ion-label><h2>V programu</h2></ion-label>
          <ion-badge color="light">{{ (publicEvents | async)?.length }}</ion-badge>
        </ion-item>
        <div class="column bg-light px-2 py-2 mb-3">
          <ng-container *ngTemplateOutlet="eventsColumn; context: { $implicit: publicEvents | async }"></ng-container>
        </div>
      </div>
    </div>
  </div>
</ion-content>
